
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Energy Intelligence Dashboard</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
:root {
  --bg:      #080c10;
  --surface: #0d1320;
  --card:    #111928;
  --border:  #1e2d45;
  --accent1: #00e5ff;
  --accent2: #ff6b35;
  --accent3: #7b61ff;
  --accent4: #00ff9d;
  --text:    #e8f0fe;
  --muted:   #6b7fa3;
  --glow:    rgba(0,229,255,0.15);
  --font:    'Syne', sans-serif;
  --mono:    'DM Mono', monospace;
}
html { scroll-behavior: smooth; }
body { background: var(--bg); color: var(--text); font-family: var(--font); min-height: 100vh; overflow-x: hidden; }

/* NAV */
nav {
  position: sticky; top: 0; z-index: 100;
  display: flex; align-items: center;
  background: rgba(8,12,16,0.95); backdrop-filter: blur(20px);
  border-bottom: 1px solid var(--border); padding: 0 2rem;
}
.nav-brand { font-size: 1.1rem; font-weight: 800; color: var(--accent1); padding: 1.1rem 0; margin-right: 2rem; }
.nav-brand span { color: var(--text); }
.nav-tabs { display: flex; }
.nav-tab {
  padding: 1.1rem 1.25rem; cursor: pointer; font-size: 0.8rem;
  font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase;
  color: var(--muted); border-bottom: 2px solid transparent; transition: all 0.2s;
}
.nav-tab:hover { color: var(--text); }
.nav-tab.active { color: var(--accent1); border-bottom-color: var(--accent1); }

/* PAGES */
.page { display: none; padding: 2rem; max-width: 1400px; margin: 0 auto; }
.page.active { display: block; animation: fadeUp 0.3s ease; }
@keyframes fadeUp { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }

/* PAGE HEADER */
.page-header { margin-bottom: 2rem; }
.page-title { font-size: 2rem; font-weight: 800; letter-spacing: -0.03em; }
.page-title .accent { color: var(--accent1); }
.page-subtitle { color: var(--muted); font-size: 0.88rem; margin-top: 0.4rem; font-family: var(--mono); }

/* STAT CARDS */
.stat-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem; }
.stat-card {
  background: var(--card); border: 1px solid var(--border);
  border-radius: 12px; padding: 1.25rem 1.5rem; position: relative; overflow: hidden;
  transition: border-color 0.2s, transform 0.2s;
}
.stat-card:hover { border-color: var(--accent1); transform: translateY(-2px); }
.stat-card::before {
  content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px;
  background: linear-gradient(90deg, var(--accent1), var(--accent3));
}
.stat-label { font-size: 0.7rem; font-weight: 700; letter-spacing: 0.12em; text-transform: uppercase; color: var(--muted); margin-bottom: 0.5rem; }
.stat-value { font-size: 1.8rem; font-weight: 800; letter-spacing: -0.03em; font-family: var(--mono); }
.stat-unit  { font-size: 0.78rem; color: var(--muted); margin-top: 0.2rem; font-family: var(--mono); }

/* CHART CARDS */
.chart-grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem; }
@media(max-width:1000px){ .chart-grid-2 { grid-template-columns:1fr; } }
.chart-card {
  background: var(--card); border: 1px solid var(--border);
  border-radius: 16px; padding: 1.5rem; margin-bottom: 1.5rem;
}
.chart-card:last-child { margin-bottom: 0; }
.chart-card-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1.25rem; flex-wrap: wrap; gap: .5rem; }
.chart-card-title { font-size: 0.82rem; font-weight: 700; letter-spacing: 0.08em; text-transform: uppercase; color: var(--muted); }
.chart-card-badge {
  font-size: 0.65rem; font-family: var(--mono); padding: 0.2rem 0.6rem;
  border-radius: 4px; background: rgba(0,229,255,0.08); color: var(--accent1);
  border: 1px solid rgba(0,229,255,0.2);
}
.chart-wrapper { position: relative; width: 100%; }

/* CONTROLS */
select, input[type=number], input[type=text] {
  background: var(--card); border: 1px solid var(--border); color: var(--text);
  border-radius: 8px; padding: 0.55rem 1rem; font-family: var(--font);
  font-size: 0.85rem; outline: none; cursor: pointer; transition: border-color 0.2s;
}
select:focus, input:focus { border-color: var(--accent1); box-shadow: 0 0 0 3px var(--glow); }
label { font-size: 0.72rem; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; color: var(--muted); }

/* ‚îÄ‚îÄ MODEL CARDS (comparison page) ‚îÄ‚îÄ */
.model-cards { display: grid; grid-template-columns: repeat(3,1fr); gap: 1.25rem; margin-bottom: 1.5rem; }
@media(max-width:900px){ .model-cards { grid-template-columns:1fr; } }

.model-card {
  background: var(--card); border: 1px solid var(--border);
  border-radius: 16px; padding: 1.5rem; position: relative; overflow: hidden;
  transition: border-color 0.2s, transform 0.2s;
}
.model-card:hover { transform: translateY(-3px); }
.model-card.ridge  { border-top: 3px solid var(--accent1); }
.model-card.lasso  { border-top: 3px solid var(--accent3); }
.model-card.rf     { border-top: 3px solid var(--accent2); }

.mc-name   { font-size: 1rem; font-weight: 800; margin-bottom: 0.2rem; }
.mc-alpha  { font-size: 0.75rem; font-family: var(--mono); color: var(--muted); margin-bottom: 1.2rem; }
.mc-note   {
  font-size: 0.72rem; font-family: var(--mono); color: var(--muted);
  background: rgba(255,255,255,0.03); border-radius: 6px;
  padding: 0.4rem 0.6rem; margin-top: 1rem;
}

.mc-metrics { display: grid; grid-template-columns: 1fr 1fr; gap: 0.6rem 1.2rem; }
.mc-metric-row { display: contents; }
.mc-metric-label { font-size: 0.68rem; font-weight: 700; letter-spacing: 0.08em; text-transform: uppercase; color: var(--muted); align-self: center; }
.mc-metric-vals  { display: flex; gap: 0.5rem; align-items: baseline; }
.mc-train { font-size: 0.78rem; font-family: var(--mono); color: var(--muted); }
.mc-test  { font-size: 1rem; font-weight: 700; font-family: var(--mono); }
.c1 { color: var(--accent1); }
.c2 { color: var(--accent2); }
.c3 { color: var(--accent3); }
.c4 { color: var(--accent4); }

.mc-divider { grid-column: 1/-1; height: 1px; background: var(--border); margin: 0.3rem 0; }

/* Zeroed badge */
.zeroed-list { display: flex; flex-wrap: wrap; gap: 0.35rem; margin-top: 0.75rem; }
.zeroed-tag {
  font-size: 0.65rem; font-family: var(--mono); padding: 0.15rem 0.45rem;
  border-radius: 4px; background: rgba(255,107,53,0.1); color: var(--accent2);
  border: 1px solid rgba(255,107,53,0.2);
}

/* ‚îÄ‚îÄ INSIGHTS ‚îÄ‚îÄ */
.insights-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.25rem; margin-bottom: 1.5rem; }
@media(max-width:900px){ .insights-grid { grid-template-columns:1fr; } }
.insight-card { background: var(--card); border: 1px solid var(--border); border-radius: 14px; padding: 1.4rem; }
.insight-icon { font-size: 1.5rem; margin-bottom: 0.75rem; }
.insight-title { font-size: 1rem; font-weight: 700; margin-bottom: 0.4rem; }
.insight-stat  { font-size: 2rem; font-weight: 800; font-family: var(--mono); margin: 0.6rem 0 0.3rem; }
.insight-text  { font-size: 0.85rem; color: var(--muted); line-height: 1.65; }

/* ‚îÄ‚îÄ PREDICT ‚îÄ‚îÄ */
.ridge-banner {
  display: flex; align-items: center; gap: 1rem;
  background: linear-gradient(135deg, rgba(0,229,255,0.07), rgba(123,97,255,0.07));
  border: 1px solid rgba(0,229,255,0.25); border-radius: 14px;
  padding: 1rem 1.5rem; margin-bottom: 1.5rem;
}
.ridge-banner-icon { font-size: 1.5rem; flex-shrink:0; }
.ridge-banner-title { font-size: 0.9rem; font-weight: 700; }
.ridge-banner-title code { font-family: var(--mono); color: var(--accent1); background: rgba(0,229,255,0.1); padding: 0.1rem 0.4rem; border-radius: 4px; }
.ridge-banner-sub { font-size: 0.75rem; color: var(--muted); font-family: var(--mono); margin-top: 0.2rem; }
.ridge-banner-badge {
  margin-left: auto; flex-shrink:0; font-size: 0.65rem; font-weight: 700;
  letter-spacing: 0.1em; text-transform: uppercase; padding: 0.3rem 0.8rem;
  border-radius: 20px; background: rgba(0,255,157,0.1); color: var(--accent4);
  border: 1px solid rgba(0,255,157,0.25);
}

.predict-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(195px,1fr)); gap: 1rem; margin-bottom: 1.5rem; }
.form-group { display: flex; flex-direction: column; gap: 0.4rem; }
.predict-btn {
  display: inline-flex; align-items: center; gap: 0.5rem;
  background: var(--accent1); color: var(--bg); border: none;
  border-radius: 10px; padding: 0.75rem 2.2rem;
  font-family: var(--font); font-weight: 800; font-size: 0.9rem;
  letter-spacing: 0.04em; cursor: pointer; transition: opacity 0.2s, transform 0.15s;
}
.predict-btn:hover { opacity: 0.88; transform: translateY(-1px); }
.predict-btn:disabled { opacity: 0.5; cursor: not-allowed; }
.predict-result {
  background: linear-gradient(135deg, rgba(0,229,255,0.06), rgba(123,97,255,0.06));
  border: 1px solid var(--accent1); border-radius: 14px; padding: 1.5rem 2rem;
  display: none; margin-top: 1.5rem; animation: fadeUp 0.3s ease;
}
.predict-result.visible { display: block; }
.pr-label { font-size: 0.72rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--muted); }
.pr-value { font-size: 3.2rem; font-weight: 800; letter-spacing: -0.04em; color: var(--accent1); font-family: var(--mono); }
.pr-meta  { font-size: 0.78rem; color: var(--muted); margin-top: 0.3rem; font-family: var(--mono); }

/* STATE TABLE */
.model-table-wrap { overflow-x: auto; }
table { width: 100%; border-collapse: collapse; font-family: var(--mono); font-size: 0.84rem; }
th { padding: 0.7rem 1rem; text-align: left; font-size: 0.68rem; letter-spacing: 0.1em; text-transform: uppercase; color: var(--muted); font-family: var(--font); font-weight: 700; border-bottom: 2px solid var(--border); }
td { padding: 0.85rem 1rem; border-bottom: 1px solid rgba(30,45,69,0.4); }
tr:last-child td { border-bottom: none; }
tr:hover td { background: rgba(0,229,255,0.025); }

.state-search { width:100%; max-width:300px; margin-bottom:1rem; }
::-webkit-scrollbar { width:6px; height:6px; }
::-webkit-scrollbar-track { background:var(--bg); }
::-webkit-scrollbar-thumb { background:var(--border); border-radius:4px; }
</style>
</head>
<body>

<nav>
  <div class="nav-brand">‚ö° Energy<span>IQ</span></div>
  <div class="nav-tabs">
    <div class="nav-tab active" data-page="dashboard">Overview</div>
    <div class="nav-tab" data-page="insights">Insights</div>
    <div class="nav-tab" data-page="states">States</div>
    <div class="nav-tab" data-page="models">Models</div>
    <div class="nav-tab" data-page="predict">Predict</div>
  </div>
</nav>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê OVERVIEW ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="dashboard" class="page active">
  <div class="page-header">
    <div class="page-title">Energy <span class="accent">Overview</span></div>
    <div class="page-subtitle">Nationwide consumption summary ¬∑ all states ¬∑ all time</div>
  </div>
  <div class="stat-grid" id="statsGrid"><div style="color:var(--muted);font-size:.85rem">Loading‚Ä¶</div></div>

  <div class="chart-card">
    <div class="chart-card-header">
      <span class="chart-card-title">Energy Consumption Over Time</span>
      <div style="display:flex;gap:.6rem;align-items:center">
        <select id="tsStateFilter"><option value="All">All States</option></select>
        <span class="chart-card-badge" id="tsBadge">‚Äì</span>
      </div>
    </div>
    <div class="chart-wrapper" style="height:280px"><canvas id="tsChart"></canvas></div>
  </div>

  <div class="chart-grid-2">
    <div class="chart-card" style="margin-bottom:0">
      <div class="chart-card-header"><span class="chart-card-title">Monthly Average Usage</span><span class="chart-card-badge">Seasonal</span></div>
      <div class="chart-wrapper" style="height:220px"><canvas id="monthlyChart"></canvas></div>
    </div>
    <div class="chart-card" style="margin-bottom:0">
      <div class="chart-card-header"><span class="chart-card-title">Weekday vs Weekend</span><span class="chart-card-badge">Behavioural</span></div>
      <div class="chart-wrapper" style="height:220px"><canvas id="wwChart"></canvas></div>
    </div>
  </div>
  <div style="margin-top:1.5rem" class="chart-grid-2">
    <div class="chart-card" style="margin-bottom:0">
      <div class="chart-card-header"><span class="chart-card-title">Usage Distribution</span><span class="chart-card-badge">Histogram</span></div>
      <div class="chart-wrapper" style="height:220px"><canvas id="distChart"></canvas></div>
    </div>
    <div class="chart-card" style="margin-bottom:0">
      <div class="chart-card-header"><span class="chart-card-title">Feature Importance (RF)</span><span class="chart-card-badge">Top 10</span></div>
      <div class="chart-wrapper" style="height:220px"><canvas id="fiChart"></canvas></div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê INSIGHTS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="insights" class="page">
  <div class="page-header">
    <div class="page-title">Data <span class="accent">Insights</span></div>
    <div class="page-subtitle">Patterns, correlations and seasonal behaviour</div>
  </div>
  <div class="insights-grid" id="insightCards"></div>

  <div class="chart-card">
    <div class="chart-card-header"><span class="chart-card-title">Correlation Heatmap</span><span class="chart-card-badge">Numeric features</span></div>
    <div class="chart-wrapper" style="height:420px"><canvas id="corrChart"></canvas></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê STATES ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="states" class="page">
  <div class="page-header">
    <div class="page-title">State <span class="accent">Analysis</span></div>
    <div class="page-subtitle">Per-state energy consumption breakdown</div>
  </div>
  <div class="chart-card">
    <div class="chart-card-header"><span class="chart-card-title">Average Usage by State</span><span class="chart-card-badge">Ranked</span></div>
    <div class="chart-wrapper" style="height:320px"><canvas id="stateBarChart"></canvas></div>
  </div>
  <div class="chart-card">
    <div class="chart-card-header"><span class="chart-card-title">State Statistics</span></div>
    <input type="text" class="state-search" id="stateSearch" placeholder="Search state‚Ä¶">
    <div class="model-table-wrap">
      <table>
        <thead><tr><th>State</th><th>Avg Usage</th><th>Total Usage</th><th>Max</th><th>Min</th></tr></thead>
        <tbody id="stateTableBody"></tbody>
      </table>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MODELS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="models" class="page">
  <div class="page-header">
    <div class="page-title">Model <span class="accent">Comparison</span></div>
    <div class="page-subtitle">Ridge ¬∑ Lasso ¬∑ Random Forest ‚Äî metrics from energy2.ipynb</div>
  </div>

  <!-- 3 metric cards -->
  <div class="model-cards" id="modelCards"></div>

  <!-- Charts row -->
  <div class="chart-grid-2">
    <div class="chart-card" style="margin-bottom:0">
      <div class="chart-card-header"><span class="chart-card-title">R¬≤ Score ‚Äî Train vs Test</span><span class="chart-card-badge">Higher = better</span></div>
      <div class="chart-wrapper" style="height:260px"><canvas id="r2Chart"></canvas></div>
    </div>
    <div class="chart-card" style="margin-bottom:0">
      <div class="chart-card-header"><span class="chart-card-title">MAE ‚Äî Train vs Test</span><span class="chart-card-badge">Lower = better</span></div>
      <div class="chart-wrapper" style="height:260px"><canvas id="maeChart"></canvas></div>
    </div>
  </div>
  <div style="margin-top:1.5rem" class="chart-grid-2">
    <div class="chart-card" style="margin-bottom:0">
      <div class="chart-card-header"><span class="chart-card-title">RMSE ‚Äî Train vs Test</span><span class="chart-card-badge">Lower = better</span></div>
      <div class="chart-wrapper" style="height:260px"><canvas id="rmseChart"></canvas></div>
    </div>
    <div class="chart-card" style="margin-bottom:0">
      <div class="chart-card-header"><span class="chart-card-title">Test MSE Comparison</span><span class="chart-card-badge">Lower = better</span></div>
      <div class="chart-wrapper" style="height:260px"><canvas id="mseChart"></canvas></div>
    </div>
  </div>

  <!-- Radar -->
  <div class="chart-card" style="margin-top:1.5rem">
    <div class="chart-card-header"><span class="chart-card-title">Model Performance Radar (Test Set)</span><span class="chart-card-badge">Normalised scores</span></div>
    <div class="chart-wrapper" style="height:340px"><canvas id="radarChart"></canvas></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PREDICT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="predict" class="page">
  <div class="page-header">
    <div class="page-title">Live <span class="accent">Prediction</span></div>
    <div class="page-subtitle">Energy usage forecast via pre-trained Ridge model</div>
  </div>

  <div class="ridge-banner">
    <div class="ridge-banner-icon">üì¶</div>
    <div>
      <div class="ridge-banner-title">Using <code>ridge_model.pkl</code> ‚Äî loaded from disk</div>
      <div class="ridge-banner-sub">Ridge Regression ¬∑ Œ± = 10 ¬∑ 16 features ¬∑ Test R¬≤ = 0.9752</div>
    </div>
    <div class="ridge-banner-badge">Pre-trained</div>
  </div>

  <div class="chart-card">
    <div class="chart-card-header">
      <span class="chart-card-title">Input Features</span>
      <span class="chart-card-badge">16 features</span>
    </div>
    <div class="predict-grid">
      <div class="form-group"><label>Latitude</label><input type="number" id="p_latitude"    placeholder="e.g. 17.38"  step="0.01"></div>
      <div class="form-group"><label>Longitude</label><input type="number" id="p_longitude"   placeholder="e.g. 78.47"  step="0.01"></div>
      <div class="form-group"><label>Temperature</label><input type="number" id="p_temperature" placeholder="e.g. 32.5"   step="0.1"></div>
      <div class="form-group"><label>Humidity</label><input type="number" id="p_humidity"     placeholder="e.g. 65"     step="1"></div>
      <div class="form-group"><label>Day of Week (0=Mon)</label><input type="number" id="p_DayOfWeek"  min="0" max="6"  placeholder="0‚Äì6"></div>
      <div class="form-group"><label>Is Weekend (0/1)</label><input type="number" id="p_IsWeekend"   min="0" max="1"  placeholder="0 or 1"></div>
      <div class="form-group"><label>Day</label><input type="number" id="p_Day"         min="1" max="31" placeholder="1‚Äì31"></div>
      <div class="form-group"><label>Month</label><input type="number" id="p_Month"       min="1" max="12" placeholder="1‚Äì12"></div>
      <div class="form-group"><label>Quarter</label><input type="number" id="p_Quarter"     min="1" max="4"  placeholder="1‚Äì4"></div>
      <div class="form-group"><label>Lag 1 (prev day)</label><input type="number" id="p_Lag1"        placeholder="e.g. 120"></div>
      <div class="form-group"><label>Lag 7</label><input type="number" id="p_Lag7"        placeholder="e.g. 115"></div>
      <div class="form-group"><label>Lag 14</label><input type="number" id="p_Lag14"       placeholder="e.g. 118"></div>
      <div class="form-group"><label>Rolling 7-day avg</label><input type="number" id="p_Rolling7"    placeholder="e.g. 117"></div>
      <div class="form-group"><label>Rolling 14-day avg</label><input type="number" id="p_Rolling14"   placeholder="e.g. 116"></div>
      <div class="form-group"><label>Rolling 30-day avg</label><input type="number" id="p_Rolling30"   placeholder="e.g. 114"></div>
      <div class="form-group"><label>Rolling Std 7</label><input type="number" id="p_RollingStd7" placeholder="e.g. 8.2"></div>
    </div>
    <button class="predict-btn" id="predictBtn" onclick="runPredict()">‚ö° Predict Usage</button>
    <div class="predict-result" id="predictResult">
      <div class="pr-label">Predicted Energy Usage</div>
      <div class="pr-value" id="predictValue">‚Äì</div>
      <div class="pr-meta"  id="predictMeta">‚Äì</div>
    </div>
  </div>
</div>

<script>
Chart.defaults.color = '#6b7fa3';
Chart.defaults.borderColor = '#1e2d45';
Chart.defaults.font.family = "'DM Mono', monospace";
Chart.defaults.font.size = 11;

const C = { a1:'#00e5ff', a2:'#ff6b35', a3:'#7b61ff', a4:'#00ff9d', muted:'#6b7fa3', border:'#1e2d45' };
const charts = {};
function mkChart(id, type, data, opts={}) {
  const ctx = document.getElementById(id); if (!ctx) return;
  if (charts[id]) charts[id].destroy();
  charts[id] = new Chart(ctx, { type, data, options:{ responsive:true, maintainAspectRatio:false, ...opts }});
}

// NAV
document.querySelectorAll('.nav-tab').forEach(t => t.addEventListener('click', () => {
  document.querySelectorAll('.nav-tab').forEach(x => x.classList.remove('active'));
  document.querySelectorAll('.page').forEach(x => x.classList.remove('active'));
  t.classList.add('active');
  document.getElementById(t.dataset.page).classList.add('active');
  if (!inited[t.dataset.page]) { inited[t.dataset.page]=true; pages[t.dataset.page]?.(); }
}));
const inited = { dashboard: false, insights: false, states: false, models: false, predict: false };
const pages  = { dashboard: initDashboard, insights: initInsights, states: initStates, models: initModels };
inited.dashboard = true; initDashboard();

// ‚ïê‚ïê SHARED CHART OPTIONS ‚ïê‚ïê
function lineOpts() {
  return {
    responsive:true, maintainAspectRatio:false,
    interaction:{ mode:'index', intersect:false },
    plugins:{ legend:{ labels:{ color:C.muted, boxWidth:12 }}, tooltip:{ backgroundColor:'#0d1320', borderColor:C.border, borderWidth:1 }},
    scales:{ x:{ grid:{ color:C.border }, ticks:{ color:C.muted }}, y:{ grid:{ color:C.border }, ticks:{ color:C.muted }}}
  };
}
function barOpts(extra={}) {
  return {
    responsive:true, maintainAspectRatio:false,
    plugins:{ legend:{ labels:{ color:C.muted, boxWidth:12 }}, tooltip:{ backgroundColor:'#0d1320', borderColor:C.border, borderWidth:1 }},
    scales:{ x:{ grid:{ display:false }, ticks:{ color:C.muted }}, y:{ grid:{ color:C.border }, ticks:{ color:C.muted }}},
    ...extra
  };
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DASHBOARD
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function initDashboard() {
  const [ov, stateList] = await Promise.all([
    fetch('/api/overview').then(r=>r.json()),
    fetch('/api/state_list').then(r=>r.json()),
  ]);

  document.getElementById('statsGrid').innerHTML = `
    <div class="stat-card"><div class="stat-label">Records</div><div class="stat-value">${ov.total_records.toLocaleString()}</div><div class="stat-unit">data points</div></div>
    <div class="stat-card"><div class="stat-label">States</div><div class="stat-value">${ov.num_states}</div><div class="stat-unit">unique regions</div></div>
    <div class="stat-card"><div class="stat-label">Date Range</div><div class="stat-value" style="font-size:.95rem;line-height:1.3;margin-top:.2rem">${ov.date_range}</div></div>
    <div class="stat-card"><div class="stat-label">Avg Usage</div><div class="stat-value" style="color:var(--accent1)">${ov.avg_usage}</div><div class="stat-unit">kWh per record</div></div>
    <div class="stat-card"><div class="stat-label">Peak Usage</div><div class="stat-value" style="color:var(--accent2)">${ov.max_usage}</div><div class="stat-unit">max single record</div></div>
    <div class="stat-card"><div class="stat-label">Total Usage</div><div class="stat-value">${(ov.total_usage/1e6).toFixed(2)}M</div><div class="stat-unit">aggregate kWh</div></div>
  `;

  const tsf = document.getElementById('tsStateFilter');
  stateList.forEach(s => tsf.innerHTML += `<option value="${s}">${s}</option>`);
  tsf.addEventListener('change', () => loadTS(tsf.value));
  await loadTS('All');

  const [m, ww, dist, fi] = await Promise.all([
    fetch('/api/monthly').then(r=>r.json()),
    fetch('/api/weekday_weekend').then(r=>r.json()),
    fetch('/api/distribution').then(r=>r.json()),
    fetch('/api/feature_importance').then(r=>r.json()),
  ]);

  mkChart('monthlyChart','line',{
    labels: m.months,
    datasets:[{ label:'Avg Usage', data:m.usage, borderColor:C.a1, backgroundColor:'rgba(0,229,255,0.07)', tension:0.4, fill:true, pointRadius:4, pointBackgroundColor:C.a1 }]
  }, lineOpts());

  mkChart('wwChart','bar',{
    labels: ww.labels,
    datasets:[{ label:'Avg Usage', data:ww.values, backgroundColor:[C.a3,C.a2], borderRadius:8, borderSkipped:false }]
  }, barOpts({ plugins:{ legend:{ display:false }}}));

  mkChart('distChart','bar',{
    labels: dist.bins,
    datasets:[{ label:'Count', data:dist.counts, backgroundColor:'rgba(0,229,255,0.3)', borderColor:C.a1, borderWidth:1, borderRadius:2 }]
  }, barOpts({ plugins:{ legend:{ display:false }}}));

  mkChart('fiChart','bar',{
    labels: fi.features.slice(0,10),
    datasets:[{ label:'Importance', data:fi.importance.slice(0,10),
      backgroundColor: fi.importance.slice(0,10).map((_,i)=>`hsla(${185+i*15},75%,58%,0.75)`),
      borderRadius:4, borderSkipped:false }]
  }, barOpts({ indexAxis:'y', plugins:{ legend:{ display:false }}}));
}

async function loadTS(state) {
  const url = state==='All' ? '/api/timeseries' : `/api/timeseries?state=${encodeURIComponent(state)}`;
  const ts = await fetch(url).then(r=>r.json());
  document.getElementById('tsBadge').textContent = `${ts.dates.length} points`;
  mkChart('tsChart','line',{
    labels: ts.dates,
    datasets:[{ label:'Usage', data:ts.usage, borderColor:C.a1, backgroundColor:'rgba(0,229,255,0.04)', tension:0.3, fill:true, pointRadius:0, borderWidth:2 }]
  },{
    ...lineOpts(),
    scales:{ x:{ grid:{color:C.border}, ticks:{color:C.muted, maxTicksLimit:10}}, y:{grid:{color:C.border},ticks:{color:C.muted}}}
  });
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INSIGHTS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function initInsights() {
  const [ov, ww, m, corr] = await Promise.all([
    fetch('/api/overview').then(r=>r.json()),
    fetch('/api/weekday_weekend').then(r=>r.json()),
    fetch('/api/monthly').then(r=>r.json()),
    fetch('/api/correlation').then(r=>r.json()),
  ]);

  const wkDiff = (((ww.values[1]-ww.values[0])/ww.values[0])*100).toFixed(1);
  const maxMon = m.months[m.usage.indexOf(Math.max(...m.usage))];
  const minMon = m.months[m.usage.indexOf(Math.min(...m.usage))];

  document.getElementById('insightCards').innerHTML = `
    <div class="insight-card">
      <div class="insight-icon">üìÖ</div>
      <div class="insight-title">Peak Season</div>
      <div class="insight-stat" style="color:var(--accent1)">${maxMon}</div>
      <div class="insight-text">Consumption peaks in <strong>${maxMon}</strong> and dips in <strong>${minMon}</strong>. The seasonal swing reflects heating/cooling demand driven by temperature extremes across states.</div>
    </div>
    <div class="insight-card">
      <div class="insight-icon">üè†</div>
      <div class="insight-title">Weekend Effect</div>
      <div class="insight-stat" style="color:var(--accent2)">${wkDiff > 0 ? '+':''}${wkDiff}%</div>
      <div class="insight-text">Weekend consumption is <strong>${Math.abs(wkDiff)}% ${wkDiff>0?'higher':'lower'}</strong> than weekdays ‚Äî suggesting ${wkDiff>0?'residential loads dominate':'commercial demand drives weekday peaks'}.</div>
    </div>
    <div class="insight-card">
      <div class="insight-icon">üîó</div>
      <div class="insight-title">Lag Dominance</div>
      <div class="insight-stat" style="color:var(--accent4)">Lag1 ‚Üí 30.7%</div>
      <div class="insight-text">Previous day's usage (<strong>Lag1</strong>) is the single strongest predictor at 30.7% importance, confirming high autocorrelation. Rolling averages collectively account for ~43%.</div>
    </div>
    <div class="insight-card">
      <div class="insight-icon">üåç</div>
      <div class="insight-title">Geography Spans ${ov.num_states} States</div>
      <div class="insight-stat" style="color:var(--accent3)">${ov.date_range.split('‚Äì')[0].trim()}</div>
      <div class="insight-text">Data runs <strong>${ov.date_range}</strong> across ${ov.num_states} states, capturing India's climate, economic and behavioural diversity in a single dataset.</div>
    </div>
  `;

  // Heatmap via scatter
  const n = corr.labels.length;
  const pts = [];
  for (let i=0;i<n;i++) for (let j=0;j<n;j++) pts.push({x:j,y:i,v:corr.matrix[i][j]});
  if (charts['corrChart']) charts['corrChart'].destroy();
  charts['corrChart'] = new Chart(document.getElementById('corrChart'), {
    type:'scatter',
    data:{ datasets:[{
      data: pts,
      pointStyle:'rect',
      pointRadius: ctx => (ctx.chart.width/n)*0.46,
      backgroundColor: ctx => {
        const v=ctx.raw.v;
        return v>=0 ? `rgba(0,229,255,${Math.abs(v)*0.85})` : `rgba(255,107,53,${Math.abs(v)*0.85})`;
      },
      borderColor:'transparent'
    }]},
    options:{
      responsive:true, maintainAspectRatio:false,
      plugins:{ legend:{display:false}, tooltip:{ callbacks:{ label:c=>`${corr.labels[c.raw.y]} ‚Üî ${corr.labels[c.raw.x]}: ${c.raw.v}` }}},
      scales:{
        x:{ type:'linear', min:-0.5, max:n-0.5, ticks:{stepSize:1,color:C.muted,callback:v=>corr.labels[v]||''}, grid:{display:false}},
        y:{ type:'linear', min:-0.5, max:n-0.5, reverse:true, ticks:{stepSize:1,color:C.muted,callback:v=>corr.labels[v]||''}, grid:{display:false}}
      }
    }
  });
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STATES
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let allStateRows = [];
async function initStates() {
  allStateRows = (await fetch('/api/states').then(r=>r.json())).sort((a,b)=>b.avg-a.avg);
  mkChart('stateBarChart','bar',{
    labels: allStateRows.map(s=>s.state),
    datasets:[{ label:'Avg Usage', data:allStateRows.map(s=>s.avg),
      backgroundColor: allStateRows.map((_,i)=>`hsla(${190+i*3.5},75%,55%,0.72)`),
      borderRadius:3, borderSkipped:false }]
  }, barOpts({
    plugins:{ legend:{display:false}},
    scales:{ x:{ticks:{maxRotation:90,color:C.muted},grid:{display:false}}, y:{grid:{color:C.border},ticks:{color:C.muted}}}
  }));
  renderStateTable(allStateRows);
  document.getElementById('stateSearch').addEventListener('input', e => {
    const q=e.target.value.toLowerCase();
    renderStateTable(allStateRows.filter(s=>s.state.toLowerCase().includes(q)));
  });
}
function renderStateTable(rows) {
  document.getElementById('stateTableBody').innerHTML = rows.map(s=>`
    <tr>
      <td><strong>${s.state}</strong></td>
      <td style="color:var(--accent1)">${s.avg}</td>
      <td>${(s.total/1e3).toFixed(1)}K</td>
      <td style="color:var(--accent2)">${s.max}</td>
      <td style="color:var(--accent4)">${s.min}</td>
    </tr>`).join('');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// MODELS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function initModels() {
  const data = await fetch('/api/models').then(r=>r.json());
  const colors = [C.a1, C.a3, C.a2];
  const cls    = ['ridge','lasso','rf'];

  // ‚îÄ‚îÄ Metric cards ‚îÄ‚îÄ
  document.getElementById('modelCards').innerHTML = data.map((m,i)=>`
    <div class="model-card ${cls[i]}">
      <div class="mc-name" style="color:${colors[i]}">${m.name}</div>
      <div class="mc-alpha">${m.alpha}</div>
      <div class="mc-metrics">
        <div class="mc-metric-label">R¬≤</div>
        <div class="mc-metric-vals">
          <span class="mc-train">${m.train_r2}</span>
          <span class="mc-test" style="color:${colors[i]}">${m.test_r2}</span>
        </div>
        <div class="mc-metric-label">MAE</div>
        <div class="mc-metric-vals">
          <span class="mc-train">${m.train_mae}</span>
          <span class="mc-test" style="color:${colors[i]}">${m.test_mae}</span>
        </div>
        <div class="mc-metric-label">MSE</div>
        <div class="mc-metric-vals">
          <span class="mc-train">${m.train_mse}</span>
          <span class="mc-test" style="color:${colors[i]}">${m.test_mse}</span>
        </div>
        <div class="mc-metric-label">RMSE</div>
        <div class="mc-metric-vals">
          <span class="mc-train">${m.train_rmse}</span>
          <span class="mc-test" style="color:${colors[i]}">${m.test_rmse}</span>
        </div>
        <div class="mc-metric-label">MAPE</div>
        <div class="mc-metric-vals">
          <span class="mc-train" style="color:var(--muted)">test only</span>
          <span class="mc-test" style="color:${colors[i]}">${m.mape}%</span>
        </div>
      </div>
      ${m.zeroed && m.zeroed.length ? `
        <div style="font-size:.68rem;color:var(--muted);margin-top:.9rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase;">Zeroed by Lasso</div>
        <div class="zeroed-list">${m.zeroed.map(z=>`<span class="zeroed-tag">${z}</span>`).join('')}</div>
      ` : ''}
      <div class="mc-note">${m.note}</div>
    </div>
  `).join('');

  const names = data.map(m=>m.name);

  // R¬≤ chart
  mkChart('r2Chart','bar',{
    labels: names,
    datasets:[
      { label:'Train R¬≤', data:data.map(m=>m.train_r2), backgroundColor:'rgba(123,97,255,0.6)', borderRadius:6, borderSkipped:false },
      { label:'Test R¬≤',  data:data.map(m=>m.test_r2),  backgroundColor:'rgba(0,229,255,0.75)', borderRadius:6, borderSkipped:false },
    ]
  }, barOpts({ scales:{ x:{grid:{display:false},ticks:{color:C.muted}}, y:{min:0.93,max:1,grid:{color:C.border},ticks:{color:C.muted}}}}));

  // MAE chart
  mkChart('maeChart','bar',{
    labels: names,
    datasets:[
      { label:'Train MAE', data:data.map(m=>m.train_mae), backgroundColor:'rgba(255,107,53,0.55)', borderRadius:6, borderSkipped:false },
      { label:'Test MAE',  data:data.map(m=>m.test_mae),  backgroundColor:'rgba(255,107,53,0.9)',  borderRadius:6, borderSkipped:false },
    ]
  }, barOpts());

  // RMSE chart
  mkChart('rmseChart','bar',{
    labels: names,
    datasets:[
      { label:'Train RMSE', data:data.map(m=>m.train_rmse), backgroundColor:'rgba(0,255,157,0.45)', borderRadius:6, borderSkipped:false },
      { label:'Test RMSE',  data:data.map(m=>m.test_rmse),  backgroundColor:'rgba(0,255,157,0.85)', borderRadius:6, borderSkipped:false },
    ]
  }, barOpts());

  // MSE chart
  mkChart('mseChart','bar',{
    labels: names,
    datasets:[
      { label:'Train MSE', data:data.map(m=>m.train_mse), backgroundColor:'rgba(123,97,255,0.45)', borderRadius:6, borderSkipped:false },
      { label:'Test MSE',  data:data.map(m=>m.test_mse),  backgroundColor:'rgba(123,97,255,0.85)', borderRadius:6, borderSkipped:false },
    ]
  }, barOpts());

  // Radar ‚Äî normalise each metric (lower MAE/RMSE/MSE = better ‚Üí invert)
  const maxMAE  = Math.max(...data.map(m=>m.test_mae));
  const maxRMSE = Math.max(...data.map(m=>m.test_rmse));
  const maxMSE  = Math.max(...data.map(m=>m.test_mse));
  mkChart('radarChart','radar',{
    labels:['Test R¬≤','Low MAE','Low RMSE','Low MSE','Low MAPE'],
    datasets: data.map((m,i)=>({
      label: m.name,
      data:[
        m.test_r2,
        1 - m.test_mae/maxMAE,
        1 - m.test_rmse/maxRMSE,
        1 - m.test_mse/maxMSE,
        1 - m.mape/Math.max(...data.map(x=>x.mape)),
      ].map(v=>+(v*100).toFixed(1)),
      borderColor: colors[i],
      backgroundColor: colors[i].replace('#','').length===6
        ? `${colors[i]}22` : colors[i]+'22',
      pointBackgroundColor: colors[i],
      borderWidth: 2,
    }))
  },{
    responsive:true, maintainAspectRatio:false,
    plugins:{ legend:{ labels:{ color:C.muted, boxWidth:12 }}},
    scales:{ r:{
      grid:{ color:C.border }, angleLines:{ color:C.border },
      ticks:{ color:C.muted, backdropColor:'transparent', stepSize:20 },
      pointLabels:{ color:C.muted, font:{ size:11 }},
      min:0, max:100,
    }}
  });
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PREDICT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function runPredict() {
  const FIELDS = ['latitude','longitude','temperature','humidity','DayOfWeek',
    'IsWeekend','Day','Month','Quarter','Lag1','Lag7','Lag14',
    'Rolling7','Rolling14','Rolling30','RollingStd7'];
  const body = {};
  FIELDS.forEach(f => { const v=document.getElementById('p_'+f).value; body[f]=v===''?0:parseFloat(v); });

  const btn = document.getElementById('predictBtn');
  btn.textContent='‚è≥ Predicting‚Ä¶'; btn.disabled=true;

  try {
    const res = await fetch('/api/predict',{
      method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(body)
    }).then(r=>r.json());
    if (res.error) throw new Error(res.error);
    document.getElementById('predictValue').textContent = res.prediction + ' kWh';
    document.getElementById('predictMeta').textContent  = res.model;
    document.getElementById('predictResult').classList.add('visible');
  } catch(e) { alert('Prediction failed: '+e.message); }

  btn.textContent='‚ö° Predict Usage'; btn.disabled=false;
}
</script>
</body>
</html>
